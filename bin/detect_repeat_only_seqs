#!/usr/bin/env perl

use strict;
use warnings;

use 5.8.0;  # recent perl to avoid surprises

use Bio::SeqIO;
use Data::Dumper;

#use Getopt::Long;
#use Text::Wrap;
#use XML::Simple;

use strict;
use warnings;

my $NOLOG = 1;
my $LIMIT = shift;
$LIMIT ||= 64;
die "First agrument has to be a positive integer" unless $LIMIT =~ /^\d+$/;

my $file = shift;

print "Date: ". `date` unless $NOLOG;

my $in = Bio::SeqIO->new(-file => $file,
                         -format => 'Fasta');
my $out = Bio::SeqIO->new(-format => 'Fasta', -flush => 0);

while ( my $seq = $in->next_seq() ) {

        my $seq2string = $seq->seq;
        $seq2string =~ s/N//g;
	$seq->seq($seq2string);
        my ($len) =  length $seq2string;
        #print $seq->id, ": ", $seq->length, " -> ", $len, "\n"
        #    if $len < $LIMIT;
        if ($len < $LIMIT) {
            print $seq->id, ": ". "skipped, high complexity seq shorter than $LIMIT nt [$len]\n" and next
                unless $NOLOG;
            next;
        }
        $out->write_seq($seq);

}

print "Date: ". `date` unless $NOLOG;
